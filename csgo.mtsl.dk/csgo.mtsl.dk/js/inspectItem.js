import{user as t,goToPreviousPage as e,getPlayerLevel as n,numToValuta as i}from"/script.js?v=2.19";import{getItem as s,itemQualities as o,itemRarity as a,renderItem as r,getItemContainer as l,giveItem as c}from"/js/items.js?v=2.19";import{game as m}from"/js/game.js?v=2.19";import{openCase as p}from"/js/opencase.js?v=2.19";import{Pages as d}from"/js/pages.js?v=2.19";const y=15;const u=d.createPage("inspect");const x=u.q(".inspect-top");x.q("button.button.back-btn",{text:"Back",onclick(){e()}});const k=x.q(".inspect-title");const b=u.q(".center").q(".inspect-image");const f=u.q(".inspect-case");const h=f.q(".inspect-case-wheel");const g=f.q(".inspect-case-options");const N=g.q("button.button",{text:"Open",onclick(){p(B,1)}});const v=g.q("button.button",{text:"+",onclick(){w.classList.add("show")}});const w=g.q(".dropdown");w.q(".dropdown-text",{text:"Open"});const L=w.q(".flex");const j=L.q("button.button",{text:"2",onclick(){p(B,2)}});const O=L.q("button.button",{text:"3",onclick(){p(B,3)}});const T=L.q("button.button",{text:"4",onclick(){p(B,4)}});const M=L.q("button.button",{text:"5",onclick(){p(B,5)}});w.q(".dropdown-text",{text:"Cases"});const S=g.q("button.button",{onclick(){let e=s(B).keyName;if(t.money>=s(e).price){t.money-=s(e).price;c(e)}m.emit("update")}});const C=g.q("button.button",{onclick(){let e=s(B).keyName;if(t.money>=s(e).price*5){t.money-=s(e).price*5;c(e,5)}m.emit("update")}});g.q("div",{style:{width:"20px"}});const H=g.q("button.button",{text:"Open all cases instant",disabled:true,onclick(){}});const I=f.q(".inspect-case-content");const V=u.q(".center").q(".inspect-item-stats");let B=0;function P(e){let m=e.endsWith("&owned");B=m?e.substring(0,e.length-6):e;let d=s(B);k.innerText=d.name;k.style.color=a[d.rarity].color;b.style.backgroundImage="url("+d.src+")";I.innerHTML="";V.innerHTML="";if(d.type==="case"||d.type==="capsule"){f.classList.add("show");b.classList.add("mini");let e=0;let o=0;for(let n=0;n<t.inventory.length;n++)if(t.inventory[n]===d.keyName)e++;for(let e=0;e<t.inventory.length;e++)if(t.inventory[e]===d.name)o++;let a=d.keyName?Math.min(e,o):o;if(m){h.style.display=null;g.style.display=null}else{h.style.display="none";g.style.display="none"}N.disabled=a<1;v.disabled=a<2;j.disabled=a<2;O.disabled=a<3;T.disabled=a<4;M.disabled=a<5;if(d.keyName){S.innerHTML="Buy key for "+i(s(d.keyName).price,2);S.disabled=t.money<s(d.keyName).price;C.innerHTML="5x for "+i(s(d.keyName).price*5,2);C.disabled=t.money<s(d.keyName).price*5}S.classList.toggle("hide",!d.keyName);C.classList.toggle("hide",!d.keyName);let l=-1;let u=!t.upgrades.instantOpen;let x=t.upgrades.instantOpen===1?100:t.upgrades.instantOpen;let k=Math.min(o,x);if(u)H.innerText="Open cases instant (Buy Instant Open Upgrade to unlock!)";else if(d.keyName&&e<k){l=s(d.keyName).price*(k-e)+k*y;H.innerText="Open "+k+" case"+(k!==1?"s":"")+" instant for "+i(s(d.keyName).price*(k-e)+k*y,2)+" (will buy "+(k-e)+" keys + "+i(k*y,2)+" service fee)"}else{l=k*y;H.innerText="Open "+k+" case"+(k!==1?"s":"")+" instant for "+i(k*y,2)}H.disabled=u||t.money<l;H.onclick=()=>{if(n().level>=10&&t.money>=l){t.money-=l;if(d.keyName){let t=s(B).keyName;c(t,k-e)}p(B,k,true)}};let w=[];let L=d.content.items.sort(((t,e)=>{if(s(t).rarity>s(e).rarity)return-1;if(s(t).rarity<s(e).rarity)return 1;if(s(t).name>s(e).name)return-1;if(s(t).name<s(e).name)return 1;return 0}));let V=false;for(let t=0;t<L.length;t++){const e=s(L[t]);let n=e.short||e.name;if(w[n])continue;w[n]=true;if(e.rarity===6){if(!V)I.q(".item-container").q(".item",{style:{borderColor:"#fd0"},children:[q(".item-image",{style:{backgroundImage:"url(/images/special-item.png)"}}),q(".item-text","Special Item")]});V=true}else I.appendChild(r(s(n)))}}else if(d.type==="sticker"){f.classList.remove("show");b.classList.remove("mini");let t=l(d.name);V.q("tr",[q("th",{text:"Sticker Name"}),q("td",{text:d.name})]);V.q("tr",[q("th",{text:"Capsule"+(t.length!==1?"s":"")}),q("td",{text:t?t.join(", "):"Not available in capsules"})]);V.q("tr",[q("th",{text:"Value"}),q("td",{text:i(d.price,2)})]);V.q("tr",[q("th",{text:"Rarity"}),q("td",{text:a[d.rarity].display,style:{color:a[d.rarity].color}})])}else{f.classList.remove("show");b.classList.remove("mini");if(d.masterItem){V.q("tr",[q("th",{text:"Skin Name"}),q("td",{text:d.skin})]);V.q("tr",[q("th",{text:"Skin Weapon"}),q("td",{text:d.weapon})]);V.q("tr",[q("th",{text:"Highest Value"}),q("td",{text:i(d.price,2)})]);V.q("tr",[q("th",{text:"Lowest Value"}),q("td",{text:i(d.minPrice,2)})]);V.q("tr",[q("th",{text:"Rarity"}),q("td",{text:a[d.rarity].display,style:{color:a[d.rarity].color}})])}else{let t=l(d.name);V.q("tr",[q("th",{text:"Skin Name"}),q("td",{text:d.skin})]);V.q("tr",[q("th",{text:"Skin Weapon"}),q("td",{text:d.weapon})]);V.q("tr",[q("th",{text:"Container"+(t.length!==1?"s":"")}),q("td",{text:t?t.join(", "):"Not available in cases"})]);V.q("tr",[q("th",{text:"Value"}),q("td",{text:i(d.price,2)})]);V.q("tr",[q("th",{text:"Rarity"}),q("td",{text:a[d.rarity].display,style:{color:a[d.rarity].color}})]);V.q("tr",[q("th",{text:"Quality"}),q("td",{text:o[d.quality]})])}}k.innerText=d.name}m.on("showPage",(t=>t.page==="inspect"&&P(t.data)));