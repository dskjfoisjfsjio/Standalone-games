import{numToValuta as e,showPage as t,user as n}from"/script.js?v=2.19";import c from"/data/achievements.js?v=2.19";import i from"/js/select.js?v=2.19";import{game as s}from"/js/game.js?v=2.19";import{Pages as o}from"/js/pages.js?v=2.19";import{createNotification as m}from"/js/notifications.js?v=2.19";import{global as a}from"/script.js?v=2.19";import{addStat as l,getStatProgress as r}from"/js/stats.js?v=2.19";const d=o.createPage("achievements",[q("h1",{text:"Achievements"}),q("button.button",{text:"Show Statistics",style:{marginLeft:"30px"},onclick(){t("stats")}}),q("p",{text:"Unlocked:"}),qn("unlocked"),q("p",{text:"Locked:"}),qn("locked"),q("p",{text:"Collected:"}),qn("collected")]);let h=d.qget("unlocked");let v=d.qget("locked");let p=d.qget("collected");let u=0;export function checkAchievements(){if(a.noSpoilers)return;if(u+2e3>(new Date).getTime())return;u=(new Date).getTime();for(const e in c){if(n.achievements[e])continue;const i=c[e];i.requirements.forEach((c=>{if(r(c)>=c.amount){n.achievements[e]=true;l("achievements_completed",1);m({useHTML:true,message:`<div class="achievement-noti-title">Achievement Unlocked!</div><div class="achievement-noti-name">${i.name}</div><div class="achievement-noti-body">${i.description}</div>`,onclick(){t("achievements")}})}}))}let e=Object.keys(n.achievements).length-Object.keys(n.achievements_collected).length;i("#achievements_not_collected").innerText=e>0?e:"";i("#achievements_not_collected_b").innerText=e>0?e:""}function f(){h.innerHTML="";v.innerHTML="";p.innerHTML="";let t=Object.keys(n.achievements).length-Object.keys(n.achievements_collected).length;i("#achievements_not_collected").innerText=t>0?t:"";i("#achievements_not_collected_b").innerText=t>0?t:"";for(const t in c){const i=c[t];const o=q(".achievement");if(n.achievements[t])o.classList.add("completed");if(n.achievements_collected[t])p.appendChild(o);else if(n.achievements[t])h.appendChild(o);else v.appendChild(o);o.q(".achievement-title",{text:i.name});o.q("div.achievement-desc",{text:i.requirements.length===1&&i.requirements[0].amount>1?i.description+" ("+Math.min(r(i.requirements[0])||0,i.requirements[0].amount)+"/"+i.requirements[0].amount+")":i.description});o.q("button.button",{text:n.achievements_collected[t]?"Collected!":"Collect "+e(i.rewards[0].amount,2),disabled:!n.achievements[t]||n.achievements_collected[t],onclick:()=>{if(!n.achievements_collected[t]){i.rewards.forEach((e=>{if(e.type==="money"){n.money+=e.amount;n.xp+=e.amount*n.upgrades.xpmul;l("earnings_from_achievements",e.amount);l("xp_from_achievements",e.amount*n.upgrades.xpmul)}}));n.achievements_collected[t]=true;s.emit("update");f()}}})}}s.on("showPage",(e=>e.page==="achievements"&&f()));