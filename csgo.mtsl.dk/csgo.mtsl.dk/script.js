import{openCaseNavigateAway as e}from"/js/opencase.js?v=2.19";import"/js/settings.js?v=2.19";import{items as t,onload as o}from"/data/items.js?v=2.19";import"/js/inputs.js?v=2.19";import"/js/tips.js?v=2.19";import"/js/welcome.js?v=2.19";import"/js/sessions.js?v=2.19";import"/js/online/profile.js?v=2.19";import"/js/online/coinflip.js?v=2.19";import"/js/casino.js?v=2.19";import{getItem as a,itemQualities as r}from"/js/items.js?v=2.19";import l from"/js/select.js?v=2.19";import{game as i}from"/js/game.js?v=2.19";import{addStat as n}from"/js/stats.js?v=2.19";import{generateConvlr as s}from"/js/itemsn.js?v=2.19";import{Pages as c}from"/js/pages.js?v=2.19";import{createNotification as u}from"./js/notifications.js?v=2.19";import{lzw_decode as d,lzw_encode as g}from"/js/encode.js?v=2.19";import{getCurrency as m}from"/js/prefs.js?v=2.19";if(!localStorage.flags)localStorage.flags="";o().then((()=>{setTimeout((()=>{window.items=t;document.body.classList.add("data-loaded");s();if(window.innerWidth<500)showPage("inventory");else showPage("welcome");i.emit("update");i.emit("items-loaded");console.log("%cCC2 v2.19 ready","color:lime;");for(let e=user.inventory.length-1;e>=0;e--){let o=user.inventory[e];if(o===null){user.inventory.splice(e,1);continue}let l=a(o);if(l.masterItem){user.inventory.splice(e,1);user.inventory.push(`${l.short} (${r[l.qualities[0]]})`)}else if(!t[o]){let l=o.replace("(Factory New)","").replace("(Minimal Wear)","").replace("(Field-Tested)","").replace("(Well-Worn)","").replace("(Battle-Scarred)","").trim();let i=l.startsWith("StatTrak");let n=l.startsWith("Souvenir");l=l.replace("Souvenir","").replace("StatTrak","").trim();if(t[l]){let t=a(l);if(t.qualities[0]===undefined)console.log(t);let o=`${t.short} (${r[t.qualities[0]]||"Vanilla"})`;if(i&&t.stattrakAvailable)o="StatTrak "+o;if(n&&t.souvenirAvailable)o="Souvenir "+o;user.inventory.splice(e,1);user.inventory.push(o)}else console.log("ITEM DOESN'T EXIST ANYMORE",o,l)}}import("/js/coinflip.js?v=2.19");import("/js/crash.js?v=2.19");import("/js/mines.js?v=2.19");import("/js/roulette.js?v=2.19");import("/js/slots.js?v=2.19");import("/js/online/jackpot.js?v=2.19");import("/js/jackpot.js?v=2.19");import("/js/click.js?v=2.19");import("/js/inventory.js?v=2.19");import("/js/shop.js?v=2.19");import("/js/upgrades.js?v=2.19");import("/js/inspectItem.js?v=2.19");import("/js/lucky.js?v=2.19");import("/js/missions.js?v=2.19");import("/js/collection.js?v=2.19");import("/js/tradeup.js?v=2.19")}),500)}));let p=false;if(window.location.hostname==="localhost"){p=true;document.body.classList.add("dev");document.title="(Development) Case Clicker 2 - MTSL"}export let global={noSpoilers:false};export let currentPage="";let f=[];export function showPage(t,o,a,r,l){document.body.focus();let n=t.split("$")[0];let s=t.split("$")[1];if(f[f.length-1]===null)f.pop();if(!o)f.push(t);else if(!a)f.push(null);if(!r)i.emit("update",true);let u=document.querySelectorAll("[page]");for(let e=0;e<u.length;e++)u[e].classList.remove("show");let d=document.querySelectorAll("[nbtn]");for(let e=0;e<d.length;e++){d[e].classList.remove("active");if(d[e].getAttribute("nbtn")===n)d[e].classList.add("active")}if(f[f.length-2]==="opencase")e();if(n&&currentPage!==t)c.showPage(n);currentPage=t;i.emit("showPage",{page:n,data:s,direct:l})}export let user={money:210,tickets:0,tokens:0,xp:0,stats:{creation:(new Date).getTime()},inventory:["Spectrum Case"],upgrades:{},upgradesBought:[],achievements:{},achievements_collected:{},luckyWheelWins:[]};if(p)window.user=()=>user;function v(){return g(JSON.stringify(user))}function h(e="2"){try{if(e==="2"){return JSON.parse(d(localStorage.localsave))}}catch(e){console.error(e);delete localStorage._cbid;return user}}let y=Date.now();if(localStorage.localsave)user=h(localStorage.lsver||"1");if(!localStorage.localuser)localStorage.localuser=(new Date).getTime().toString(36)+"."+Math.floor(Math.random()*36**11).toString(36);let S=Date.now()-y;console.log("Loading your save took: "+S+"ms");if(S>1e3){u({message:"Your save file is large and impacting load times and performance. Consider selling items in your inventory to improve performance."})}function I(){if(window.disableSaving)return;try{if(w)return;let e=Date.now();let t=v();localStorage.lsver="2";if(t)localStorage.localsave=t;let o=Date.now()-e;console.log("Saving took: "+o+"ms");if(o>1e3){u({message:"Your save file is large and impacting load times and performance. Consider selling items in your inventory to improve performance."})}}catch(e){alert("An error occurred doing auto save. Please report it via the discord server! --- "+e+" - LSL:"+(localStorage.localsave?.length||0)+" - GOL:"+JSON.stringify(user).length)}}window.saveNow=I;window.onbeforeunload=()=>I();function j(){I();setTimeout(j,30*1e3)}setTimeout(j,30*1e3);let w=false;window.wipeSave=function(){w=true;delete localStorage._cbid;delete localStorage.localsave;delete localStorage.shop;delete localStorage.flags;delete localStorage.backup;delete localStorage.backupid;window.location.reload()};window.overwriteSave=function(e){delete localStorage._cbid;delete localStorage.localsave;delete localStorage.shop;delete localStorage.flags;delete localStorage.backup;delete localStorage.backupid;localStorage.localsave=e;user=h();n("save_times_imported",1);I();w=true;window.location.reload()};if(localStorage.backupid&&localStorage.backupid!==localStorage._cbid){document.getElementById("recover-btn").style.display="initial";document.getElementById("dismiss-recover-btn").style.display="initial";document.getElementById("recover-btn").onclick=()=>{if(confirm("Do you want to recover your old save? The current save will be lost.")){w=true;localStorage._cbid=localStorage.backupid;localStorage.localsave=localStorage.backup;window.location.reload()}};document.getElementById("dismiss-recover-btn").onclick=()=>{if(confirm("Are you sure?")){delete localStorage.backup;delete localStorage.backupid;localStorage._cbid=localStorage.localuser;document.getElementById("recover-btn").style.display="none";document.getElementById("dismiss-recover-btn").style.display="none"}}}let b=["Recruit","Private I","Private II","Private III","Private IV","Corporal I","Corporal II","Corporal III","Corporal IV","Sergeant I","Sergeant II","Sergeant III","Sergeant IV","Master Sergeant I","Master Sergeant II","Master Sergeant III","Master Sergeant IV","Sergeant Major I","Sergeant Major II","Sergeant Major III","Sergeant Major IV","Lieutenant I","Lieutenant II","Lieutenant III","Lieutenant IV","Captain I","Captain II","Captain III","Captain IV","Major I","Major II","Major III","Major IV","Colonel I","Colonel II","Colonel III","Brigadier General","Major General","Lieutenant General","General","Global General"];const k=.075;export function getPlayerLevel(){let e=0;function t(){let o=Math.round(e**(k*e+1)*1e3);let a=Math.round((e+1)**(k*(e+1)+1)*1e3);if(a<=user.xp&&e<40){++e;return t()}else return{level:e,xps:o,xpa:user.xp-o,xpp:(user.xp-o)/(a-o),xpn:a-o}}return t()}i.on("update",(e=>{l("#money").innerText=numToValuta(user.money,2);l("#money").tip=(user.money/100).toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2})+m();l("#tickets").innerText=numToString(user.tickets);l("#tokens").innerText=numToString(user.tokens);l("#level-bar-text-left").innerText=numToString(getPlayerLevel().xpa)+"/"+numToString(getPlayerLevel().xpn)+" xp";l("#level-bar-text-right").innerText="level "+getPlayerLevel().level;l("#level-bar-p").style.width=getPlayerLevel().xpp*100+"%";l("#level-image").style.backgroundImage='url("images/level '+getPlayerLevel().level+'.png")';l("#level-title").innerText=b[getPlayerLevel().level];Array.from(document.querySelectorAll("[display]")).forEach((e=>{switch(e.getAttribute("display")){case"tokens":e.innerText=numToString(user.tokens)+" chips";break}}));if(!e)showPage(currentPage,true,false,false,true)}));export function numToString(e,t=0){e=Math.floor(e*10**t)/10**t;if(e<1e4)return e.toFixed(t);else if(e<1e6)return e<1e5?Math.floor(e/10)/100+"k":Math.floor(e/100)/10+"k";else if(e<1e9)return e<1e7?Math.floor(e/1e4)/100+"m":Math.floor(e/1e5)/10+"m";else if(e<1e12)return Math.floor(e/1e8)/10+"t";else if(e<1e15)return Math.floor(e/1e11)/10+"q";else return Math.floor(e/1e12)+"q"}export function numToValuta(e,t=0){switch(localStorage.prefcurrency){case"dollar":return"$"+numToString(e/100,t);default:return numToString(e/100,t)+"â‚¬"}}document.onmousedown=e=>{if(!e.path)e.path=e.composedPath();for(let t=0;t<e.path.length-2;t++)if(e.path[t].classList.contains("dropdown"))return;for(let e=0;e<l(".dropdown").length;e++)l(".dropdown")[e].classList.remove("show");Array.from(document.getElementsByClassName("js-dropdown")).forEach((e=>{document.body.removeChild(e)}))};export function goToPreviousPage(){if(f.length>1){f.pop();showPage(f[f.length-1],true,true)}}let P=document.querySelectorAll("[showpage]");for(let E=0;E<P.length;E++)P[E].onclick=()=>showPage(P[E].getAttribute("showpage"));window.addEventListener("touchstart",(function(e){if(e.target.tagName!=="BUTTON"&&e.target.classList.contains("item")){e.preventDefault()}}),{passive:false});window.addEventListener("keydown",(e=>{if(e.key==="Escape")goToPreviousPage()}));window.addEventListener("resize",(()=>i.emit("update")));setInterval((()=>{user.money+=user.upgrades.passiveIncome*user.upgrades.perClick||0;n("earned_passive",user.upgrades.passiveIncome*user.upgrades.perClick||0);i.emit("update",true)}),1e3);setInterval((()=>{localStorage.lastSeen=Math.floor((new Date).getTime()/1e3).toString(36)}),1e3);function T(e,t){let o=Math.min(t,user.upgrades.offlineRate*user.upgrades.offlineTime);const a=document.body.q(".dialog-overlay");a.q(".floating-dialog",{children:[q(".floating-dialog-header",{children:[q(".floating-dialog-title","Offline Income"),q(".floating-dialog-close",{onclick(){document.body.removeChild(a)}})]}),q(".floating-dialog-body",{children:[q(".floating-dialog-text",`Welcome back! You have earned ${(o/100).toFixed(2)}${m()} while being offline for ${(e/60/60).toFixed(1)} hours!`),q(".floating-dialog-text",o===t?``:user.upgrades.offlineTime===600?`This is the maximum amount of money you can earn offline!`:`But if your offline income time limit was higher, you could have earned ${(Math.min(t,user.upgrades.offlineRate*600)/100).toFixed(2)}${m()}...`)]})]})}function x(){let e=Math.ceil((new Date).getTime()/1e3)-parseInt(localStorage.lastSeen,36);let t=Math.floor(user.upgrades.offlineRate*e/60);if(t>100){T(e,t);user.money+=Math.min(t,user.upgrades.offlineRate*user.upgrades.offlineTime);n("earned_offline",Math.min(t,user.upgrades.offlineRate*user.upgrades.offlineTime));i.emit("update")}}x();setTimeout((()=>i.emit("update")),100);document.body.classList.add("game-ready");setInterval((()=>{if(!user.seasonTimePlayed)user.seasonTimePlayed=0;user.seasonTimePlayed+=1;n("time_played",1)}),1e3);window.addEventListener("keydown",(e=>{if(document.activeElement.tagName==="INPUT")return;if(currentPage!=="click"&&e.key==="e")showPage("click");if(currentPage!=="shop"&&e.key==="s")showPage("shop");if(currentPage!=="betting"&&e.key==="g")showPage("betting");if(currentPage!=="upgrades"&&e.key==="u")showPage("upgrades");if(currentPage!=="missions"&&e.key==="m")showPage("missions");if(currentPage!=="achievements"&&e.key==="a")showPage("achievements");if(currentPage!=="collection"&&e.key==="c")showPage("collection");if(currentPage!=="tradeup"&&e.key==="t")showPage("tradeup");if(document.activeElement.tagName==="INPUT")e.preventDefault()}));if(!localStorage.backupid||localStorage.backupid===localStorage._cbid){localStorage.backup=localStorage.localsave;localStorage._cbid=Math.random();localStorage.backupid=localStorage._cbid}function M(){document.getElementById("menu").classList.toggle("mobile-open",true)}function L(){document.getElementById("menu").classList.toggle("mobile-open",false)}document.getElementById("mobile-nav-button").addEventListener("click",M);document.getElementById("pages").addEventListener("click",L);i.on("showPage",L);